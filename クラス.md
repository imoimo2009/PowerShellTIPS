## クラス編

### クラスのコンストラクタ

クラス名と同名のメソッドを定義すればよい。

```powershell
Class MyClass{
    [int]$a
    MyClass(){
        $this.a = 0
    }
}
```

### クラスのプロパティ

クラスの変数がそのままプロパティになる。  
ISEのインテリセンスに出したくない時は `hidden` 修飾子をつけるとよい。  
※最新の仕様ではprivate修飾子があるようだが、現バージョンでは使えない模様。

### クラスのインスタンス化

2通りのやり方がある。お好きな方で。

```powershell
$c = [<クラス名>]::new()
$c = New-Object <クラス名>
```

### 自身のプロパティ・メソッドにアクセス

`$this.<プロパティorメソッド>` という構文でアクセスする。

```powershell
class Hoge {
    [string] $s
    
    GetStr(){
        return $this.s #プロパティの参照
    }
    
    GetString(){
        return $this.GetStr() #メソッドを呼び出す
    }
}
```

### クラスの静的プロパティ・メソッドへのアクセス

クラスの静的(static)メソッドにアクセスしたいときに使用。  
ちなみに自身に定義した静的メソッドへも同様の記述でアクセスできる。  
（特に.NETクラスの定数とかを取りたいときに多用する）  
`[<クラス名称>]::<プロパティorメソッド>`  

```powershell
class Hoge {
    static [int] $a #静的プロパティ
    
    # Hogeクラスのコンストラクタ
    Hoge(){
        [Hoge]::a = 1 #静的プロパティに値を設定
    }
}
```

### クラスの継承

`class <クラス名称> : <継承元クラス名称> {}` で継承できる。

```powershell
class Fuga : Hoge {
    #処理
}
```

### 継承元クラスメソッドのオーバーライド

継承したクラスで継承元クラスにあるメソッドと同名のメソッドを定義できる。  
全く違うメソッドにすることもできるし継承元メソッドを呼び出すことで機能拡張もできる。

```powershell
class Fuga : Hoge {
    Hage(){
        ([Hoge]$this).Hage() #継承元クラスのメソッド
        #追加の処理とか
    }
}
```

[戻る](/README.md)
